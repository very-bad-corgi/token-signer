#ifndef __CRYPTO_CONSTANTS__H__
#define __CRYPTO_CONSTANTS__H__

#include <Windows.h>
#include <string>

#define ALG_SID_BELT_HASH256		40
#define ALG_SID_BASH256				41
#define ALG_SID_BASH384				42
#define ALG_SID_BASH512				43
#define ALG_SID_BELT_MAC256			44

#define ALG_SID_BIGN				50
#define ALG_SID_BIGN_CURVE256v1		51
#define ALG_SID_BIGN_CURVE384v1		52
#define ALG_SID_BIGN_CURVE512v1		53


#define ALG_SID_BELT_ECB_128		60
#define ALG_SID_BELT_ECB_192		61
#define ALG_SID_BELT_ECB_256		62

#define ALG_SID_BELT_CBC_128		63
#define ALG_SID_BELT_CBC_192		64
#define ALG_SID_BELT_CBC_256		65

#define ALG_SID_BELT_CFB_128		66
#define ALG_SID_BELT_CFB_192		67
#define ALG_SID_BELT_CFB_256		68

#define ALG_SID_BELT_CTR_128		69
#define ALG_SID_BELT_CTR_192		70
#define ALG_SID_BELT_CTR_256		71

#define ALG_SID_BELT_KEYWRAP		72

#define ALG_SID_STB1176_2				80
#define ALG_SID_STB1176_2_PRE			81
#define ALG_SID_STB1176_2_PARAM3		82
#define ALG_SID_STB1176_2_PARAM6		83
#define ALG_SID_STB1176_2_PARAM10		84



#define CALG_BELT_HASH_256			(ALG_CLASS_HASH | ALG_TYPE_ANY | ALG_SID_BELT_HASH256)
#define CALG_BASH_256				(ALG_CLASS_HASH | ALG_TYPE_ANY | ALG_SID_BASH256)
#define CALG_BASH_384				(ALG_CLASS_HASH | ALG_TYPE_ANY | ALG_SID_BASH384)
#define CALG_BASH_512				(ALG_CLASS_HASH | ALG_TYPE_ANY | ALG_SID_BASH512)
#define CALG_BELT_MAC256			(ALG_CLASS_HASH | ALG_TYPE_ANY | ALG_SID_BELT_MAC256)

#define CALG_BIGN					(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_BIGN)
#define CALG_BIGN_CURVE256v1		(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_BIGN_CURVE256v1)
#define CALG_BIGN_CURVE384v1		(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_BIGN_CURVE384v1)
#define CALG_BIGN_CURVE512v1		(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_BIGN_CURVE512v1)

#define CALG_DHE_BIGN				(ALG_CLASS_KEY_EXCHANGE | ALG_TYPE_DH | ALG_SID_BIGN) // 43570

#define CALG_STB1176_2				(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_STB1176_2)
#define CALG_STB1176_2_PRE			(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_STB1176_2_PRE)
#define CALG_STB1176_2_PARAM3		(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_STB1176_2_PARAM3)
#define CALG_STB1176_2_PARAM6		(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_STB1176_2_PARAM6)
#define CALG_STB1176_2_PARAM10		(ALG_CLASS_SIGNATURE | ALG_TYPE_ANY | ALG_SID_STB1176_2_PARAM10)


#define CALG_BELT_ECB_256			(ALG_CLASS_DATA_ENCRYPT | ALG_TYPE_BLOCK | ALG_SID_BELT_ECB_256)
#define CALG_BELT_CBC_256			(ALG_CLASS_DATA_ENCRYPT | ALG_TYPE_BLOCK | ALG_SID_BELT_CBC_256)
#define CALG_BELT_CFB_256			(ALG_CLASS_DATA_ENCRYPT | ALG_TYPE_BLOCK | ALG_SID_BELT_CFB_256)
#define CALG_BELT_CTR_256			(ALG_CLASS_DATA_ENCRYPT | ALG_TYPE_BLOCK | ALG_SID_BELT_CTR_256)

#define CALG_BELT_KEYWRAP			(ALG_CLASS_DATA_ENCRYPT | ALG_TYPE_BLOCK | ALG_SID_BELT_KEYWRAP)

#define HP_PASS_VAL			0x20
#define HP_ITERATION_COUNT  0x21
#define HP_SALT_EX			0x22

#define PP_VERSION_EX		50
#define PP_DEVICE_TYPE		51
#define PP_SLOT_ID			52
#define KP_CHANGE_PASSWORD	50
#define KP_KEY_HEADER		51

namespace NTCONSTANTS
{
	const std::string BIGN_CSP_NAME = "NTCrypto STB 34.101.45 Cryptographic Provider";
	const std::string STB11762_CSP_NAME = "NTCrypto STB 1176.2 Cryptographic Provider";
	const std::string STB11762_PRE_CSP_NAME = "NTCrypto STB 1176.2pre Cryptographic Provider";

	const std::wstring BIGN_CSP_WNAME = L"NTCrypto STB 34.101.45 Cryptographic Provider";
	const std::wstring STB11762_CSP_WNAME = L"NTCrypto STB 1176.2 Cryptographic Provider";
	const std::wstring STB11762_PRE_CSP_WNAME = L"NTCrypto STB 1176.2pre Cryptographic Provider";



	const DWORD PROMPT_SELECT_DEVICE = 0x00001000;
	const DWORD SOFT_IMPL_FLAG = 0x00002000;
	const DWORD SIGMA_IMPL_FLAG = 0x00004000;
	const DWORD NTSTORE_IMPL_FLAG = 0x00008000;

	const DWORD BIGN_CSP_TYPE = 322;
	const DWORD STB11762_CSP_TYPE = 323;
	const DWORD STB11762_PRE_CSP_TYPE = 324;

	const DWORD BIGN_PUBLIC_CURVE256_MAGIC = 0x50553536;	// PU56
	const DWORD BIGN_PRIVATE_CURVE256_MAGIC = 0x50523536;	// PR56
	const DWORD BIGN_PUBLIC_CURVE384_MAGIC = 0x50553834;	// PU84
	const DWORD BIGN_PRIVATE_CURVE384_MAGIC = 0x50523834;	// PR84
	const DWORD BIGN_PUBLIC_CURVE512_MAGIC = 0x50553132;	// PU12
	const DWORD BIGN_PRIVATE_CURVE512_MAGIC = 0x50523132;	// PR12
	const DWORD BIGN_KEYTRANSPORT_BLOB_MAGIC = 0x424B5442;	//BKTB
	const DWORD BELT_KEY_MAGIC = 0x42544B4D; // BTKM
	const DWORD STB11762_PARAM3_PUBLIC_MAGIC = 0x5333504D; // S3PM
	const DWORD STB11762_PARAM6_PUBLIC_MAGIC = 0x5336504D; // S6PM
	const DWORD STB11762_PARAM10_PUBLIC_MAGIC = 0x5330504D; // S0PM
}

/*
* Key transport blob has the following format in contiguous memory:
*
* BIGN_KEY_TRANS_BLOB_HEADER blob_header;
* BYTE token[token_len]
* BYTE key_hdr[key_hdr_len]
*/
struct BIGN_KEY_TRANS_BLOB_HEADER
{
	DWORD magic = NTCONSTANTS::BIGN_KEYTRANSPORT_BLOB_MAGIC;
	DWORD token_len = 0;
	DWORD key_hdr_len = 0;
};

struct TZI_ASYMM_KEY_BLOB_HEADER
{
	/*
	Can be one of the following:
	BIGN_PUBLIC_CURVE256_MAGIC
	BIGN_PRIVATE_CURVE256_MAGIC
	BIGN_PUBLIC_CURVE384_MAGIC
	BIGN_PRIVATE_CURVE384_MAGIC
	BIGN_PUBLIC_CURVE512_MAGIC
	BIGN_PRIVATE_CURVE512_MAGIC
	*/
	DWORD magic = 0;
	DWORD pub_key_len = 0;
	DWORD priv_key_len = 0;
};

struct TZI_SYMM_KEY_BLOB_HEADER
{
	DWORD magic = 0;
	DWORD length = 0;
};

#endif // __CRYPTO_CONSTANTS__H__